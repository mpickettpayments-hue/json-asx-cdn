:root{
  --bg:#0b0f14;
  --panel:#0c1117;
  --panel2:#10161d;
  --muted:#8aa0b2;
  --text:#e4eef8;
  --accent:#1DAFFF;      /* neon blue */
  --accent2:#5BD7FF;     /* hover/active */
  --line:#172231;
  --radius:14px;
  --sidebarW:82px;       /* W2 */
}

/* Reset */
*{box-sizing:border-box}
html,body{height:100%}
body{margin:0;background:#06090d;color:var(--text);font-family:Inter,system-ui,Segoe UI,Roboto,Arial,sans-serif}

/* Shell grid */
.shell{
  display:grid;
  grid-template-columns: var(--sidebarW) 1fr;
  grid-template-rows: 56px calc(100% - 56px);
  grid-template-areas:
    "sidebar topbar"
    "sidebar content";
  height:100%;
}

/* Sidebar (matte black) */
.sidebar{
  grid-area:sidebar;
  background:#000;
  display:flex;
  flex-direction:column;
  align-items:center;
  padding:10px 0;
  border-right:1px solid #0a0a0a;
}
.brand img{width:42px;height:42px;border-radius:8px;object-fit:cover;margin:8px 0 10px}
.nav{display:flex;flex-direction:column;gap:10px;width:100%;align-items:center}
.nav-btn{
  width:54px;height:54px;border-radius:12px;border:1px solid #0f0f0f;background:#0a0a0a;display:flex;align-items:center;justify-content:center;cursor:pointer;position:relative;
  transition:transform .16s ease, box-shadow .16s ease, border-color .16s ease;
  color:var(--accent);
  filter: drop-shadow(0 0 0 rgba(29,175,255,0));
}
.nav-btn:hover{
  border-color:#122538;
  box-shadow:0 0 18px rgba(91,215,255,.28), inset 0 0 8px rgba(29,175,255,.2);
  filter: drop-shadow(0 0 6px rgba(91,215,255,.55));
}
.nav-btn.active{
  border-color:#1f3f5c;
  box-shadow:0 0 22px rgba(91,215,255,.42), inset 0 0 10px rgba(29,175,255,.28);
  transform: translateZ(0) scale(1.02);
  filter: drop-shadow(0 0 8px rgba(91,215,255,.7));
}
.nav-btn i{width:22px;height:22px;stroke:var(--accent2);stroke-width:2}
.nav .spacer{flex:1}

/* Topbar */
.topbar{
  grid-area:topbar;
  background:linear-gradient(180deg,#0b1117,#0b0f14);
  border-bottom:1px solid var(--line);
  display:flex;align-items:center;justify-content:space-between;
  padding:8px 12px;
}
.channels{display:flex;gap:8px}
.chip{
  border:1px solid #203040;background:#0b131b;color:#bcd0e0;padding:6px 10px;border-radius:20px;font-size:12px;cursor:pointer
}
.chip.active{background:#17324a;border-color:#24527a;color:#e9f5ff}
.actions{display:flex;align-items:center;gap:8px}
.search{width:220px;max-width:40vw;background:#0c141c;border:1px solid #1b2734;border-radius:999px;padding:8px 12px;color:var(--text)}
.pat{width:200px;background:#0c141c;border:1px solid #1b2734;border-radius:8px;padding:8px 10px;color:var(--text)}
.btn{background:#15324a;border:1px solid #214f74;color:#d6ecff;border-radius:10px;padding:8px 12px;cursor:pointer}

/* Content area (fullscreen apps) */
.content{
  grid-area:content;
  position:relative;
  overflow:auto;
  background:radial-gradient(1200px 800px at 70% -200px, rgba(29,175,255,.07), transparent 60%), linear-gradient(180deg,#0a0e13,#0d131a 30%,#0b0f14);
  padding:18px;
}
.boot-msg{color:var(--muted);padding:12px}

/* Cards & grids (for home/store/library routes) */
.card{background:var(--panel2);border:1px solid var(--line);border-radius:var(--radius);padding:16px}
.section{margin-bottom:22px}
.h3{margin:0 0 10px 0}
.tilegrid{display:grid;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));gap:14px}
.tile{background:#0e141b;border:1px solid #172231;border-radius:12px;overflow:hidden;cursor:pointer;display:flex;flex-direction:column}
.tile img{width:100%;aspect-ratio:16/9;object-fit:cover;background:#0b0f14}
.tile .meta{padding:10px 12px;display:flex;justify-content:space-between;align-items:center;font-size:14px;color:#cfe3f4}

/* Builder slide-over (B1) */
.builder{
  position:fixed; top:56px; right:0; bottom:0; width:min(42vw,720px);
  background:linear-gradient(180deg,#0b1218,#0a0f14);
  border-left:1px solid var(--line);
  transform:translateX(100%); transition:transform .22s ease;
  z-index:50; display:flex; flex-direction:column;
}
.builder.show{transform:translateX(0)}
.builder-header{
  display:flex; align-items:center; justify-content:space-between; padding:10px 12px; border-bottom:1px solid var(--line);
}
.tabs{display:flex; gap:8px}
.tab{background:#0f1720;border:1px solid #1b2940;color:#cfe3f4;border-radius:8px;padding:6px 10px;cursor:pointer;font-size:13px}
.tab.active, .tab:hover{background:#142438;border-color:#244b71}
.icon-btn{background:transparent;border:1px solid #18222e;border-radius:8px;width:34px;height:34px;display:flex;align-items:center;justify-content:center;color:#9ccff0;cursor:pointer}
.builder-body{padding:12px; overflow:auto; flex:1; display:block}
.row{display:flex;gap:8px;margin:8px 0} .row>*{flex:1}
.code{
  width:100%;min-height:46vh;background:#0a1117;color:#dbeaf7;border:1px solid #1b2734;border-radius:10px;padding:12px;
  font-family:ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:13px; line-height:1.45;
}
.chat-log{background:#0a1117;border:1px solid #1b2734;border-radius:10px;padding:10px;color:#b6cfe4;min-height:160px}

/* Fullscreen offer */
.fs-offer{
  position:fixed; left:50%; transform:translateX(-50%); bottom:16px;
  background:#0f1720;border:1px solid #223246;color:#e9f5ff;border-radius:12px;padding:10px 14px;display:flex;gap:10px;align-items:center;z-index:60;
  box-shadow:0 8px 30px rgba(0,0,0,.35)
}
.fs-offer.hidden{display:none}

/* Hidden util */
.hidden{display:none}

/* Responsive */
@media (max-width: 900px){
  .builder{width:100vw}
  .topbar .actions{gap:6px}
  .search{max-width:52vw}
}
@media (max-width: 640px){
  .search{display:none}
  .pat{width:150px}
}
/* --- File Tree + Modal minimal additions (P3 FT-C) --- */
.files-panel { border:1px solid #1b2940;border-radius:10px;background:#0e1520;max-height:70vh;overflow:auto }
.files-head { display:flex;justify-content:space-between;align-items:center;padding:8px 10px;border-bottom:1px solid #1b2940 }
.files-title { font-weight:600 }
.files-list { padding:6px 10px }
.fitem { padding:6px 6px;border-radius:6px;cursor:pointer;font-size:14px }
.fitem.active,.fitem:hover { background:#132033 }
.fdir { font-weight:600;margin-top:6px }
.fchildren { padding-left:12px }
.modal-mask { position:fixed;inset:0;background:rgba(0,0,0,0.5);display:none;align-items:center;justify-content:center;z-index:50 }
.modal-mask.show { display:flex }
.modal { background:#0e1520;border:1px solid #1b2940;border-radius:12px;max-width:520px;width:92%;padding:16px }
.modal h3 { margin:0 0 10px }
.modal .actions { display:flex;gap:8px;justify-content:flex-end;margin-top:12px }
